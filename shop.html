<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Saleor Shop</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- jQuery + Owl Carousel -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@7/dist/ionicons/ionicons.esm.js"></script>

  <link rel="stylesheet" href="style.css">

</head>
<body class="bg-black min-h-[130vh]">

    <!-- Header -->
    <header class="bg-gray-900 shadow-lg sticky top-0 z-50 border-b border-gold-700">
        <nav class="container mx-auto px-4 py-4 flex items-center justify-between" id="desktop-nav">
            <div class="text-2xl font-bold text-gold-500"><img src="logo.png" style="height: 8vh;" alt=""></div>

            <ul class="hidden md:flex space-x-6 text-gray-300">
                <li><a href="#" class="hover:text-gold-500 transition">Home</a></li>
                <li><a href="#" class="hover:text-gold-500 transition">Shop</a></li>
                <li><a href="#" class="hover:text-gold-500 transition">Services</a></li>
                <li><a href="#" class="hover:text-gold-500 transition">Gallery</a></li>
                <li><a href="#" class="hover:text-gold-500 transition">Contact</a></li>
            </ul>
            <button class="md:hidden text-gold-500">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </nav>

    <div class="floating-icon">
        <a target="_blank" href="tel:+917738130131"><img style="max-width: initial;height: 4.5vh;" src="images/call_icon.svg" alt="" srcset=""></a>
        <a target="_blank" href="https://wa.me/+917738130131?text=Hi%20B-oneinterion%20Team"><img style="max-width: initial;height: 5.5vh;" src="images/whatsapp.svg" alt="" srcset=""></a>
    </div>

    <div id="drawer">
        <ul>
        <li><a href="#company">Company</a></li>
        <li><a href="#shop">Shop</a></li>
        <li><a href="#services">Services</a></li>
        <li><a href="#gallery">Gallery</a></li>
        <!-- <li><a href="#gallery">Locations</a></li>
        <li><a href="#gallery">Blogs</a></li> -->
        <li><a href="#contact">Contact Us</a></li>
        </ul>
    </div>
    <label for="menu-toggle" class="overlay"></label>

<div class="fixedBottom">
        <a href="https://b-oneinterior.com/" class="logoBx"></a>
        <ul>
            <li>
                <a href="https://b-oneinterior.com/company">
                    <ion-icon name="people-outline" class="text-[#D4AF37] text-2xl"></ion-icon>
                    <div>Company</div>
                </a>
            </li>
            <li>
                <a href="https://b-oneinterior.com/shop">
                    <ion-icon name="storefront-outline" class="text-[#D4AF37] text-2xl"></ion-icon>
                    <div>Shop</div>

                </a>
            </li>
            <li></li>
            <li>
                <a href="https://b-oneinterior.com/gallery">
                    <ion-icon name="images-outline"></ion-icon>
                    <div>Gallery</div>
                </a>
            </li>
            <li>
                <a href="#" id="menu-toggle" onclick="toggleMenu(this)">
                    <div>
                        <div class="menu-icon" id="menu-btn">&#9776;</div>
                        
                    </div>

                </a>

            </li>
        </ul>
</div>

  <script>
          const drawer = document.getElementById("drawer");
          const overlay = document.querySelector(".overlay");
          const menuBtn = document.getElementById("menu-btn");

          menuBtn.addEventListener("click", () => {
              drawer.style.left = drawer.style.left === "0px" ? "-250px" : "0px";
              toggleOverlay();
          });

          overlay.addEventListener("click", () => {
              drawer.style.left = "-250px";
              hideOverlay();
          });

          function toggleOverlay() {
              if (overlay.style.opacity === "1") {
                  hideOverlay();
              } else {
                  showOverlay();
              }
          }

          function showOverlay() {
              overlay.style.opacity = "1";
              overlay.style.pointerEvents = "auto";
          }

          function hideOverlay() {
              overlay.style.opacity = "0";
              overlay.style.pointerEvents = "none";
          }
    </script>
    </header>





<div class="container mx-auto px-4 py-10 space-y-6">

  <aside class="bg-gray-100 p-6 shadow rounded-lg space-y-6">
    <div>
      <h3 class="font-semibold mb-3">Categories</h3>
      <div id="categoryFilter" class="flex flex-wrap gap-2"></div>
    </div>
    <div>
      <h3 class="font-semibold mb-3">Product Types</h3>
      <div id="productTypeFilter" class="flex flex-wrap gap-2"></div>
    </div>
  </aside>

  <div id="mobileSliderWrapper" class="block md:hidden">
    <div id="mobileSlider" class="owl-carousel owl-theme"></div>
  </div>

  <main id="productGrid" class="hidden md:grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-6"></main>

</div>

<script>
const API_URL = "https://api.b-oneinterior.com/graphql/";
const HIDDEN_CATEGORY_NAME = "Gallery Image Category";
const FALLBACK_IMG = "https://via.placeholder.com/300x300?text=No+Image";

const QUERY = `
query {
  categories(first: 100) { edges { node { id name } } }
  productTypes(first: 100) { edges { node { id name } } }
  products(first: 100, channel: "in") { edges { node { id name slug category { id name } productType { id name } thumbnail { url } } } }
}
`;

async function fetchSaleor() {
  try {
    const res = await fetch(API_URL, {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({ query: QUERY })
    });
    const json = await res.json();
    if (json.errors) console.error("GraphQL errors:", json.errors);
    return json.data;
  } catch (err) {
    console.error("Fetch error:", err);
    return null;
  }
}

function renderFilters(categories, productTypes, allProducts) {
  const categoryCounts = {};
  allProducts.forEach(p => { if(p.category?.id) categoryCounts[p.category.id]=(categoryCounts[p.category.id]||0)+1; });
  const typeCounts = {};
  allProducts.forEach(p => { if(p.productType?.id) typeCounts[p.productType.id]=(typeCounts[p.productType.id]||0)+1; });

  document.getElementById("categoryFilter").innerHTML = `
    <button class="filter-category px-3 py-1 rounded-full border text-sm bg-gold text-white " data-category="all">
      All (${allProducts.length})
    </button>
    ${categories.filter(c=>c.name!==HIDDEN_CATEGORY_NAME).map(c=>`
      <button class="filter-category px-3 py-1 rounded-full border border-gray-300 text-gray-700 text-sm" data-category="${c.id}">
        ${c.name} (${categoryCounts[c.id]||0})
      </button>`).join("")}
  `;

  document.getElementById("productTypeFilter").innerHTML = `
    <button class="filter-type px-3 py-1 rounded-full border text-sm bg-gold text-white " data-type="all">
      All (${allProducts.length})
    </button>
    ${productTypes.map(t=>`
      <button class="filter-type px-3 py-1 rounded-full border border-gray-300 text-gray-700 text-sm" data-type="${t.id}">
        ${t.name} (${typeCounts[t.id]||0})
      </button>`).join("")}
  `;
}

function renderGrid(products){
  const grid = document.getElementById("productGrid");
  grid.innerHTML = products.length ? products.map(p=>`
    <div class="product-card bg-white shadow rounded-lg p-4 hover:shadow-lg transition" data-category="${p.category?.id||''}" data-type="${p.productType?.id||''}">
      <img src="${p.thumbnail?.url||FALLBACK_IMG}" class="w-full h-40 object-cover rounded mb-2" alt="${p.name}">
      <p class="font-semibold truncate">${p.name}</p>
        <div class="flex items-center justify-between text-sm text-gray-500">
            <p>${p.category?.name || "—"}</p>
            <p>${p.productType?.name || ""}</p>
        </div>
      </div>
  `).join("") : `<p class="col-span-full text-center text-gray-500">No products found.</p>`;
}

function renderSlider(products){
  const slider = $("#mobileSlider");
  slider.html("");
  products.forEach(p=>{
    slider.append(`<div class="p-2"><div class="bg-white shadow rounded-lg p-4">
      <img src="${p.thumbnail?.url||FALLBACK_IMG}" class="w-full h-50 object-cover rounded mb-2">
      <p class="font-semibold truncate">${p.name}</p>
        <div class="flex items-center justify-between text-sm text-gray-500">
            <p>${p.category?.name || "—"}</p>
            <p>${p.productType?.name || ""}</p>
        </div>
    </div></div>`);
  });
  slider.owlCarousel("destroy");
  slider.owlCarousel({items:2, margin:10, nav:true, dots:false, loop:true, autoplay:true, responsive:{0:{items:1},480:{items:2}}});
}

function setupFiltering(allProducts){
  function applyFilters(){
    const activeCat = document.querySelector(".filter-category.bg-gold")?.dataset.category||"all";
    const activeType = document.querySelector(".filter-type.bg-gold")?.dataset.type||"all";
    let filtered = allProducts;
    if(activeCat!=="all") filtered = filtered.filter(p=>p.category?.id===activeCat);
    if(activeType!=="all") filtered = filtered.filter(p=>p.productType?.id===activeType);
    renderGrid(filtered);
    renderSlider(filtered);
  }
  document.addEventListener("click",e=>{
    if(e.target.classList.contains("filter-category")){
      document.querySelectorAll(".filter-category").forEach(b=>b.classList.remove("bg-gold","text-white"));
      e.target.classList.add("bg-gold","text-white");
      applyFilters();
    }
    if(e.target.classList.contains("filter-type")){
      document.querySelectorAll(".filter-type").forEach(b=>b.classList.remove("bg-gold","text-white"));
      e.target.classList.add("bg-gold","text-white");
      applyFilters();
    }
  });
}

(async()=>{
  const data = await fetchSaleor();
  if(!data) return alert("Error fetching Saleor API");

  const categories = data.categories?.edges?.map(e=>e.node)||[];
  const productTypes = data.productTypes?.edges?.map(e=>e.node)||[];
  let products = data.products?.edges?.map(e=>e.node)||[];
  products = products.filter(p=>p.category?.name!==HIDDEN_CATEGORY_NAME);

  renderFilters(categories,productTypes,products);
  renderGrid(products);
  renderSlider(products);
  setupFiltering(products);
})();
</script>

</body>
</html>
